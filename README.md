# RET

<br>
<p align="center"> <img src="https://github.com/NameLessEG/NameLessEG-Residual-Enhancement-Transformer-CSWin-LFNet/blob/main/Figs/overview.png" width="90%"> </p>

## Updates
- **2024.04:** The code is released.

## Requirements
- Python 3.8 (Ubuntu 20.04)
- PyTorch 1.10.0
- torchvision=0.6.0
- h5py=2.8.0
- Matlab
- CUDA 11.3

## Dataset
We utilize the following datasets for both training and testing:
- EPFL
- HCInew
- HCIold
- INRIA
- STFgantry

You can download the datasets from [Baidu Drive](https://pan.baidu.com/s/1g8O8C8_YzdmerPQGjf2bLA?pwd=ac4v) (key: ac4v).

## Download the Pretrained Weights
We provide the model weights of RET. You can download them from [Baidu Drive](https://pan.baidu.com/s/1g8O8C8_YzdmerPQGjf2bLA?pwd=ac4v) (key: ac4v).

## Download the Visual Results
We share the super-resolved results generated by our RET for comparison. Results are available at [Baidu Drive](https://pan.baidu.com/s/1g8O8C8_YzdmerPQGjf2bLA?pwd=ac4v) (key: ac4v).

## Prepare the Datasets
To generate the training data:
- Use Matlab to run `GenerateTrainingData.m`

To generate the testing data:
- Use Matlab to run `GenerateTestData.m`


## Train
To perform RET training, run `python train.py`
Checkpoint will be saved to `./log/`.

## Test
To evaluate RET performance, run `python test.py`
The performance of RET on five datasets will be printed on the screen. Visual results of each scene will be saved in `./Results/`. PSNR and SSIM values of each scene will also be saved in `./PSNRSSIM/`.

## Generate Visual Results
To generate visual super-resolved results, use Matlab to run `GenerateResultImages.m`. The '.mat' files in `./Results/` will be converted to '.png' images in `./SRimages/`.

## Performance
### Quantitative comparisons
<p align="center"> <img src="https://github.com/NameLessEG/NameLessEG-Residual-Enhancement-Transformer-CSWin-LFNet/blob/main/Figs/quantitativeresults.png" width="95%"> </p>

### Visual comparisons
<p align="center">
  <img src="/Figs/visualresults.png" width="50%">
</p>
<p align="center">
  <img src="/Figs/visualresult1.png" width="50%">
</p>
